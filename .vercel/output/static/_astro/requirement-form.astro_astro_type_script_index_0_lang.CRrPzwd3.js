document.addEventListener("DOMContentLoaded",function(){const b=document.getElementById("loading-screen"),r=document.getElementById("title-screen"),M=document.getElementById("form-container");setTimeout(()=>{b.classList.add("fade-out"),setTimeout(()=>{b.style.display="none",r.style.display="flex",setTimeout(()=>{r.classList.add("fade-out"),setTimeout(()=>{r.style.display="none",M.style.display="block",z()},500)},2500)},500)},1500);function z(){const t={threshold:.1,rootMargin:"0px 0px -50px 0px"},a=new IntersectionObserver(function(e){e.forEach((s,o)=>{s.isIntersecting&&(setTimeout(()=>{s.target.classList.add("animate-in")},o*100),a.unobserve(s.target))})},t),l=document.querySelectorAll(".form-section");l.forEach(e=>{a.observe(e)}),l.length>0&&setTimeout(()=>{l[0].classList.add("animate-in")},200)}const y=document.getElementById("presale-yes"),N=document.getElementById("presale-no"),h=document.getElementById("presale-details");function v(){y.checked?h.style.display="block":h.style.display="none"}y?.addEventListener("change",v),N?.addEventListener("change",v);const g=document.getElementById("married-yes"),O=document.getElementById("married-no"),f=document.getElementById("spouse-details");function k(){g.checked?f.style.display="block":f.style.display="none"}g?.addEventListener("change",k),O?.addEventListener("change",k);const D=document.getElementById("residents"),E=document.getElementById("family-members-section"),x=document.getElementById("family-members-list"),I=document.getElementById("family-ages-list");D?.addEventListener("change",function(){const t=parseInt(this.value);if(t>0){E.style.display="block",x.innerHTML="",I.innerHTML="";for(let a=1;a<=t;a++){const l=document.createElement("input");l.type="text",l.name=`family-member-${a}`,l.placeholder=`成員 ${a} 姓名`,l.style.width="100%",l.style.padding="10px 12px",l.style.border="1px solid #ddd",l.style.borderRadius="4px",l.style.marginBottom="10px",l.style.fontSize="14px",l.style.fontFamily="'Noto Sans TC', '微軟正黑體', 'Microsoft JhengHei', sans-serif",x.appendChild(l);const e=document.createElement("input");e.type="text",e.name=`family-age-${a}`,e.placeholder=`成員 ${a} 年齡`,e.style.width="100%",e.style.padding="10px 12px",e.style.border="1px solid #ddd",e.style.borderRadius="4px",e.style.marginBottom="10px",e.style.fontSize="14px",e.style.fontFamily="'Noto Sans TC', '微軟正黑體', 'Microsoft JhengHei', sans-serif",I.appendChild(e)}}else E.style.display="none"});const H=document.getElementById("holidays-other-check"),B=document.getElementById("holidays-other-input");H?.addEventListener("change",function(){this.checked?B.style.display="block":B.style.display="none"});const F=document.getElementById("source-other-check"),L=document.getElementById("source-other-input");F?.addEventListener("change",function(){this.checked?L.style.display="block":L.style.display="none"});const J=document.getElementById("budget"),S=document.getElementById("budget-other-input");J?.addEventListener("change",function(){this.value==="other"?S.style.display="block":S.style.display="none"});const P=document.getElementById("max-budget"),$=document.getElementById("max-budget-other-input");P?.addEventListener("change",function(){this.value==="other"?$.style.display="block":$.style.display="none"}),document.getElementById("kitchen-notes-radio");const q=document.getElementById("kitchen-notes-input");document.querySelectorAll('input[name="kitchen-renovation"]').forEach(t=>{t.addEventListener("change",function(){this.value==="notes"?q.style.display="block":q.style.display="none"})}),document.getElementById("bathroom-notes-radio");const C=document.getElementById("bathroom-notes-input");document.querySelectorAll('input[name="bathroom-renovation"]').forEach(t=>{t.addEventListener("change",function(){this.value==="notes"?C.style.display="block":C.style.display="none"})}),document.getElementById("cad-notes-radio");const T=document.getElementById("cad-notes-input");document.querySelectorAll('input[name="cad-file"]').forEach(t=>{t.addEventListener("change",function(){this.value==="notes"?T.style.display="block":T.style.display="none"})});const w=document.querySelectorAll(".space-checkbox"),A=document.getElementById("space-details-container"),Y={"living-room":{title:"客廳",options:[{label:"造型電視牆",value:"tv-wall"},{label:"收納櫃",value:"storage-cabinet"},{label:"展示櫃",value:"display-cabinet"},{label:"L型沙發",value:"l-sofa"},{label:"一字型沙發",value:"straight-sofa"},{label:"其他",value:"other"}]},"dining-room":{title:"餐廳",options:[{label:"電器櫃",value:"appliance-cabinet"},{label:"餐櫃",value:"dining-cabinet"},{label:"中島",value:"island"},{label:"餐桌",value:"dining-table",hasInput:!0,inputLabel:"人餐桌"},{label:"一字型沙發",value:"straight-sofa"},{label:"其他",value:"other"}]},bathroom:{title:"浴廁",options:[{label:"主衛浴鏡櫃",value:"master-mirror"},{label:"客衛浴鏡櫃",value:"guest-mirror"},{label:"主衛浴浴缸",value:"master-bathtub"},{label:"客衛浴浴缸",value:"guest-bathtub"},{label:"其他",value:"other"}]},kitchen:{title:"廚房",options:[{label:"電器櫃",value:"appliance-cabinet"},{label:"冰箱櫃",value:"refrigerator-cabinet"},{label:"中島",value:"island"},{label:"吧台",value:"bar-counter"},{label:"其他",value:"other"}]},"master-bedroom":{title:"主臥房",options:[{label:"各種床尺寸",value:"bed-size"},{label:"化妝桌",value:"makeup-table"},{label:"書桌",value:"desk"},{label:"更衣室",value:"walk-in-closet"},{label:"電視",value:"tv"},{label:"窗簾需全遮光才有辦法入睡",value:"blackout-curtain"}]},"children-room":{title:"小孩房",options:[{label:"各種床尺寸",value:"bed-size"},{label:"化妝桌",value:"makeup-table"},{label:"書桌",value:"desk"},{label:"更衣室",value:"walk-in-closet"},{label:"電視",value:"tv"},{label:"窗簾需全遮光才有辦法入睡",value:"blackout-curtain"}]},"guest-room":{title:"客房",options:[{label:"各種床尺寸",value:"bed-size"},{label:"化妝桌",value:"makeup-table"},{label:"書桌",value:"desk"},{label:"更衣室",value:"walk-in-closet"},{label:"電視",value:"tv"},{label:"窗簾需全遮光才有辦法入睡",value:"blackout-curtain"}]},"elderly-room":{title:"孝親房",options:[{label:"各種床尺寸",value:"bed-size"},{label:"化妝桌",value:"makeup-table"},{label:"書桌",value:"desk"},{label:"更衣室",value:"walk-in-closet"},{label:"電視",value:"tv"},{label:"窗簾需全遮光才有辦法入睡",value:"blackout-curtain"}]},"study-room":{title:"書房",options:[{label:"各種床尺寸",value:"bed-size"},{label:"化妝桌",value:"makeup-table"},{label:"書桌",value:"desk"},{label:"更衣室",value:"walk-in-closet"},{label:"電視",value:"tv"},{label:"窗簾需全遮光才有辦法入睡",value:"blackout-curtain"}]},"tatami-room":{title:"和室",options:[{label:"書桌",value:"desk"},{label:"自動升降桌",value:"lift-table"},{label:"活動茶桌",value:"tea-table"},{label:"電視",value:"tv"}]}};function R(){A.innerHTML="",w.forEach(t=>{if(t.checked){const a=t.value,l=Y[a];if(l){const e=document.createElement("div");e.className="space-detail-section";let s="";l.options.forEach(n=>{n.hasInput?s+=`
                  <div style="margin-bottom: 10px;">
                    <label class="checkbox-label">
                      <input type="checkbox" name="${a}-details" value="${n.value}" class="dining-table-check">
                      <span>${n.label}</span>
                    </label>
                    <div class="dining-table-input-wrapper" style="display: none;">
                      <input type="text" name="${a}-dining-table-people" placeholder="人數" style="width: 80px; padding: 6px 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                      <span>人餐桌</span>
                    </div>
                  </div>
                `:n.value==="other"?s+=`
                  <div style="margin-bottom: 10px;">
                    <label class="checkbox-label">
                      <input type="checkbox" name="${a}-details" value="${n.value}" class="other-check" data-space="${a}">
                      <span>${n.label}</span>
                    </label>
                    <div class="other-input-wrapper" style="display: none; margin-top: 8px;">
                      <input type="text" name="${a}-other-details" placeholder="請說明其他需求" style="width: 100%; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; font-family: 'Noto Sans TC', '微軟正黑體', 'Microsoft JhengHei', sans-serif;">
                    </div>
                  </div>
                `:s+=`
                  <label class="checkbox-label">
                    <input type="checkbox" name="${a}-details" value="${n.value}">
                    <span>${n.label}</span>
                  </label>
                `}),e.innerHTML=`
              <h3 class="space-detail-title">${l.title}</h3>
              <div class="checkbox-group">
                ${s}
              </div>
            `,A.appendChild(e),setTimeout(()=>{e.style.opacity="1",e.style.transform="translateY(0)"},50);const o=e.querySelector(".dining-table-check"),d=e.querySelector(".dining-table-input-wrapper");o&&d&&o.addEventListener("change",function(){this.checked?d.style.display="flex":d.style.display="none"}),e.querySelectorAll(".other-check").forEach(n=>{const c=n.closest("div").querySelector(".other-input-wrapper");c&&n.addEventListener("change",function(){if(this.checked)c.style.display="block";else{c.style.display="none";const m=c.querySelector("input");m&&(m.value="")}})})}}})}w.forEach(t=>{t.addEventListener("change",R)});function u(){const t=document.getElementById("requirement-form");if(!t)return;const a=t.querySelectorAll('input:not([type="hidden"]), select, textarea');t.querySelectorAll("input[required], select[required], textarea[required]");let l=a.length,e=0;a.forEach(i=>{if(i.type==="checkbox"||i.type==="radio"){const n=i.name;n&&t.querySelector(`input[name="${n}"]:checked`)&&t.querySelectorAll(`input[name="${n}"]:checked`).length>0&&e++;const c=t.querySelectorAll(`input[name="${n}"]`);c.length>1&&i!==c[0]&&l--}else i.value&&i.value.trim()!==""&&e++});const s=Math.round(e/l*100),o=document.getElementById("progress-fill"),d=document.getElementById("progress-percentage");o&&(o.style.width=s+"%"),d&&(d.textContent=s+"%")}const p=document.getElementById("requirement-form");p&&(p.addEventListener("input",u),p.addEventListener("change",u),setTimeout(u,500))});
